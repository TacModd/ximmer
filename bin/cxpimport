#!/bin/bash

BASE=`cd $(dirname $0 | xargs dirname); pwd`

unset GROOVY_HOME

# Set JAVA_HOME based on java location
if [ -z "$JAVA_HOME" ];
then
    export JAVA_HOME=`dirname $(which java) | xargs dirname`
fi

: ${XIMMER_MEM:=20g}
JAVA_OPTS="-Xmx$XIMMER_MEM -noverify -Dsamjdk.reference_fasta=$XIMMER_REF -Dsnappy.disable=true -Djava.io.tmpdir=./.ximmertmp -Dximmer.base=$BASE"

export JAVA_OPTS

$BASE/tools/groovy/3.0.10/bin/groovy \
-cp $BASE/src/main/groovy:$BASE/src/main/resources:$BASE/tools/groovy-ngs-utils/current/groovy-ngs-utils.jar \
    $BASE/src/main/groovy/PostToCXP.groovy $*

